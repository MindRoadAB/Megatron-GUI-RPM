<VirtualHost *:80>

	DocumentRoot /var/www/megatron-gui/web

	WSGIScriptAlias /flask /var/www/megatron-gui/api/api.wsgi

	RewriteEngine on
	RewriteRule ^/api/(.*)	/flask/api/$1	[PT]

	<Directory /var/www/megatron-gui/web>
		Require all granted

		# Fix to handle react-router paths
		RewriteEngine on
		# Don't rewrite files or directories
		RewriteCond %{REQUEST_FILENAME} -f [OR]
		RewriteCond %{REQUEST_FILENAME} -d
		RewriteRule ^ - [L]
		# Rewrite everything else to index.html to allow html5 state links
		RewriteRule ^ index.html [L]
	</Directory>

	<Directory /var/www/megatron-gui/api>
		Require all granted
	</Directory>

</VirtualHost>
